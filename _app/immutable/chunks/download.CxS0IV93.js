import{h as i}from"./scheduler.y4uHs2UB.js";import{s as g}from"./settings.RqfMgPN1.js";import{d as n}from"./device.BfQL0yu1.js";import{t as d}from"./translations.C2mFf6Kf.js";import{r as l}from"./index.CdrgBhix.js";let c;const u=l([],(t,e)=>{c=e});function p(t){c(e=>(e.push(t),e))}function v(){c(t=>(t.pop(),t))}const k=Object.freeze(Object.defineProperty({__proto__:null,createDialog:p,default:u,killDialog:v},Symbol.toStringTag,{value:"Module"})),s=({url:t,file:e,body:o,urlType:a})=>{const r={type:"saving",id:"saving",file:e,url:t,urlType:a};o&&(r.bodyText=o),p(r)},f=t=>{const e=document.createElement("a"),o=URL.createObjectURL(t);e.href=o,e.download=t.name,e.click(),URL.revokeObjectURL(o)},m=async t=>await(navigator==null?void 0:navigator.share({files:[new File([t],t.name,{type:t.type})]})),w=t=>{if(!["http:","https:"].includes(new URL(t).protocol))return alert("error: invalid url!");if(!window.open(t,"_blank"))return s({url:t,body:i(d)("dialog.saving.blocked")})},h=async t=>await(navigator==null?void 0:navigator.share({url:t})),b=async t=>{var e;return await((e=navigator==null?void 0:navigator.clipboard)==null?void 0:e.writeText(t))},D=({url:t,file:e,urlType:o})=>{var r;if(!t&&!e)throw new Error("attempted to download void");const a=i(g).save.savingMethod;if(a==="ask")return s({url:t,file:e,urlType:o});if(!((r=navigator==null?void 0:navigator.userActivation)!=null&&r.isActive))return s({url:t,file:e,body:i(d)("dialog.saving.timeout"),urlType:o});try{if(e){if(a==="share"&&n.supports.share)return m(e);if(a==="download"&&n.supports.directDownload)return f(e)}if(t){if(a==="share"&&n.supports.share)return h(t);if(a==="download"&&n.supports.directDownload&&!(n.is.iOS&&o==="redirect"))return w(t);if(a==="copy"&&!e)return b(t)}}catch{}return s({url:t,file:e,urlType:o})};export{b as a,u as b,p as c,D as d,f as e,m as f,k as g,v as k,w as o,h as s};
