import i from"./turnstile.CRdjaMbJ.js";import{currentApiURL as u}from"./api-url.CNe_fggu.js";let t;const p=async()=>{const s=`${u()}/session`;let e={};const n=i.getResponse();n&&(e={"cf-turnstile-response":n});const a=await fetch(s,{method:"POST",redirect:"manual",signal:AbortSignal.timeout(1e4),headers:e}).then(r=>r.json()).catch(r=>{var o;if((o=r==null?void 0:r.message)!=null&&o.includes("timed out"))return{status:"error",error:{code:"error.api.timed_out"}}});return i.reset(),a},l=async()=>{const s=()=>Math.floor(new Date().getTime()/1e3);if(t!=null&&t.token&&(t==null?void 0:t.exp)-2>s())return t;const e=await p();return e?("status"in e||(e.exp=s()+e.exp,t=e),e):{status:"error",error:{code:"error.api.unreachable"}}};export{l as getSession,p as requestSession};
